{"version":3,"sources":["utils/DeriNumberFormat.js","pages/AirDrop/img/time.svg","pages/AirDrop/img/pToken.svg","pages/AirDrop/AirDrop.js"],"names":["Wrapper","styled","NumberFormat","props","width","LoadLine","div","test","height","DeriNumberFormat","renderablity","setRenderablity","useState","className","firstTime","setFirstTime","isValidate","allowZero","value","undefined","isNaN","Math","abs","renderText","replace","useEffect","wallet","closeShowLoadingEffectAfterLoaded","defaultValue","others","decimalScale","bg","toFixed","countDecimal","toPlainString","displayType","fixedDecimalScale","thousandSeparator","timeout","window","setTimeout","clearTimeout","suffix","inject","observer","lang","type","balance","setBalance","disabled","setDisabled","alert","useAlert","info","setInfo","isWhite","setIsWhite","isPToken","setIsPToken","isExist","setIsExist","getBalance","async","isConnected","res","apiProxy","request","detail","chainId","account","isUserInPTokenWhiteListV3","isPTokenAirdroppedV3","isUserPTokenExistV3","deadline","valid","timestamp","Date","getTime","getInfo","formatAddress","src","tokenLogo","alt","timeLogo","Button","fontWeight","label","fontSize","onClick","includeResponse","success","error","isTransaction","link","blockExploreUrl","response","data","blockHash","title","eqInNumber"],"mappings":"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","file":"static/js/24.47a3b872.chunk.js","sourcesContent":["import React,{useState,useEffect,useRef} from 'react'\nimport ReactDOM from 'react-dom'\nimport NumberFormat from 'react-number-format'\nimport { inject, observer } from 'mobx-react';\nimport styled from 'styled-components';\nimport { toPlainString,countDecimal } from './utils';\nimport { bg } from '../lib/web3js';\nconst Wrapper = styled(NumberFormat)`\n  width : ${props => props.width}px;\n`\nconst LoadLine = styled.div`\n  width : ${props => /px$/.test(props.width) ? props.width : `${props.width}px`};\n  height : ${props => /px$/.test(props.height) ? props.height : `${props.height}px`};\n`\nfunction DeriNumberFormat(props){\n  const [renderablity, setRenderablity] = useState(<span className='loading-line'></span>);\n  const [firstTime, setFirstTime] = useState(true)\n  const isValidate = () => {\n    const {allowZero} = props \n    return (typeof props.value !== 'object' && props.value !== undefined && props.value !== ''  && !isNaN(props.value) && props.value !== 'NaN') \n          || ((Math.abs(props.value)) === 0 && allowZero === true )\n  }\n  const renderText = value => value && value.replace(/\\.$/,'')\n\n  useEffect(() => {\n    const {allowZero,wallet,closeShowLoadingEffectAfterLoaded,defaultValue = '--',...others} = props \n\n    if(isValidate()) {\n      //如果精度截取之后为0，则动态获取精度，取到不为0为止\n      if(others.decimalScale > 0 && !allowZero && others.value && /\\d+\\.0*[1-9]+/.test(others.value)  && (+bg(others.value).toFixed((+others.decimalScale || 2))) === 0){\n        others.decimalScale = countDecimal(Math.abs(others.value)) + 2\n      } \n\n      if(others.decimalScale === -1){\n        delete others.decimalScale\n      }\n\n      others.value = toPlainString(others.value)\n      if(others.value && /\\d+.9{6}/.test(others.value)){\n        others.value = (+others.value).toFixed(5)\n      }\n      setRenderablity(<Wrapper {...others}  renderText={renderText}\n      displayType = 'text'  fixedDecimalScale={true} thousandSeparator={true}/>)\n    } else if(firstTime){\n      const {width,height} = props\n      setRenderablity(<LoadLine className='loading-line' width={width} height={height}></LoadLine>)\n      if(closeShowLoadingEffectAfterLoaded){\n        setFirstTime(false)\n      }\n    } \n    const timeout = window.setTimeout(() => {\n      // && wallet && (!wallet.isConnected() || !wallet.supportChain)\n      if(!isValidate()){\n        setRenderablity(defaultValue)\n      }\n    },60000)\n    return () => {\n      clearTimeout(timeout)\n    };\n  }, [props.value,props.decimalScale,props.suffix]);\n\n  return renderablity;\n}\nexport default DeriNumberFormat\n// export default inject('wallet')(observer(DeriNumberFormat))","export default __webpack_public_path__ + \"static/media/time.0b0bfc0e.svg\";","export default __webpack_public_path__ + \"static/media/pToken.9cfdd57f.svg\";","import { useState, useEffect } from 'react'\nimport { inject, observer } from 'mobx-react'\nimport { formatAddress, eqInNumber } from '../../utils/utils'\nimport { useAlert } from 'react-alert'\nimport DeriNumberFormat from '../../utils/DeriNumberFormat'\nimport Button from '../../components/Button/Button'\nimport apiProxy from '../../model/ApiProxy'\nimport timeLogo from './img/time.svg'\nimport tokenLogo from './img/pToken.svg'\nimport './airdrop.less'\nfunction AriDrop({ lang, wallet = {}, type = 'deri' }) {\n  const [balance, setBalance] = useState(0);\n  const [disabled, setDisabled] = useState(true);\n  const alert = useAlert();\n  const [info, setInfo] = useState({})\n  const [isWhite, setIsWhite] = useState(false)\n  const [isPToken, setIsPToken] = useState(true)\n  const [isExist, setIsExist] = useState(true)\n  const getBalance = async () => {\n    if (wallet.isConnected()) {\n      let res = await apiProxy.request('getDeriBalance', [wallet.detail.chainId, wallet.detail.account])\n      setBalance(res)\n    }\n  }\n  const getInfo = async () => {\n    let info = await apiProxy.request('getUserInfoAllForAirDrop', [wallet.detail.account])\n    let deadline = info.deadline * 1000\n    setInfo(info)\n    setDisabled(!info.valid)\n    let timestamp = new Date()\n    if (timestamp.getTime() >= deadline) {\n      setDisabled(true)\n    }\n    if (timestamp.getTime() >= 1647000000000) {\n      setDisabled(true)\n    }\n  }\n\n  const click = async () => {\n    if (type === 'pToken') {\n      let res = await apiProxy.request('airdropPTokenV3', [wallet.detail.chainId, wallet.detail.account], { includeResponse: true })\n      if (!res.success) {\n        alert.error(lang['claim-failed'])\n      }\n      if (res.success) {\n        alert.success('Claim Airdrop', {\n          timeout: 5000,\n          isTransaction: true,\n          link: `${wallet.blockExploreUrl}/tx/${res.response.data.blockHash}`,\n          title: 'Claim Airdrop Executed'\n        })\n        setDisabled(true)\n      }\n    } else {\n      if (!info.valid) {\n        alert.error(lang['no-deri-to-claim']);\n        return;\n      }\n      if (!eqInNumber(wallet.detail.chainId, info.chainId)) {\n        alert.error(lang['please-switch-to-BSC-to-claim-deri'])\n        return;\n      }\n      let res = await apiProxy.request('mintAirdrop', [info.chainId, wallet.detail.account], { includeResponse: true })\n      if (!res.success) {\n        alert.error(lang['claim-failed'])\n      }\n      if (res.success) {\n        setDisabled(true)\n      }\n      getBalance()\n    }\n\n  }\n\n  const isUserInPTokenWhiteListV3 = async () => {\n    let res = await apiProxy.request('isUserInPTokenWhiteListV3', [wallet.detail.chainId, wallet.detail.account])\n    setIsWhite(res)\n  }\n  const isPTokenAirdroppedV3 = async () => {\n    let res = await apiProxy.request('isPTokenAirdroppedV3', [wallet.detail.chainId, wallet.detail.account])\n    setIsPToken(res)\n  }\n\n  const isUserPTokenExistV3 = async () => {\n    let res = await apiProxy.request('isUserPTokenExistV3', [wallet.detail.chainId, wallet.detail.account])\n    setIsExist(res)\n  }\n\n  useEffect(() => {\n    if (wallet.isConnected()) {\n      getBalance()\n      if (type === 'pToken') {\n        isUserInPTokenWhiteListV3()\n        isPTokenAirdroppedV3()\n        isUserPTokenExistV3()\n      } else {\n        getInfo()\n      }\n    }\n\n  }, [wallet, wallet.detail, type])\n\n  useEffect(() => {\n    if (isWhite && !isExist && !isPToken) {\n      let timestamp = new Date()\n      if (timestamp.getTime() >= 1649757600000) {\n        setDisabled(true)\n      } else {\n        setDisabled(false)\n\n      }\n    }\n  }, [isWhite, isExist, isPToken])\n  return (\n    <div className='airdrop-box'>\n      <div className='airdrop-info'>\n        <div className='airdrop-info-box'>\n          <div className='airdrop-title'>\n            {lang['title']}\n          </div>\n          <div className='wallet-address'>\n            <span className='blue-logo'></span>\n            {formatAddress(wallet.detail.account)}\n          </div>\n          <div className='wallet-balance'>\n            {lang['wallet-balance']} : <DeriNumberFormat value={balance} decimalScale={0} thousandSeparator={true} /> DERI\n          </div>\n          {type === 'pToken' && <div className='airdrop-time position-text'>\n            <div className='time-logo'>\n              <img src={tokenLogo} alt='' />\n            </div>\n            <div className='time-text'>\n              <div className='time-title'>\n                <div>\n                  Get free mBTC^2 perpetual\n                </div>\n                <div>\n                  powers position\n                </div>\n              </div>\n            </div>\n          </div>}\n          {type === 'pToken' && <div className='airdrop-time position'>\n            <div className='time-logo'>\n              <img src={timeLogo} alt='' />\n            </div>\n            <div className='time-text'>\n              <div className='time-title'>\n                <div>\n                  {lang['start-time']}\n                </div>\n                <div>\n                  {lang['expire-time']}\n                </div>\n              </div>\n              <div>\n                <div>\n                  2022-04-08 10:00:00 UTC\n                </div>\n                <div>\n                  2022-04-12 10:00:00 UTC\n                </div>\n              </div>\n            </div>\n          </div>}\n          {type === 'deri' && <div className='airdrop-time'>\n            <div className='time-logo'>\n              <img src={timeLogo} alt='' />\n            </div>\n            <div className='time-text'>\n              <div className='time-title'>\n                <div>\n                  {lang['start-time']}\n                </div>\n                <div>\n                  {lang['expire-time']}\n                </div>\n              </div>\n              <div>\n                <div>\n                  2022-03-09 10:00:00 UTC\n                </div>\n                <div>\n                  2022-03-11 12:00:00 UTC\n                </div>\n              </div>\n            </div>\n          </div>}\n\n          <div className='claim'>\n            <Button fontWeight='bold' disabled={disabled} label={lang['claim']} width='277' height='72' fontSize='32' onClick={click} />\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}\nexport default inject('wallet', 'poolManager')(observer(AriDrop))"],"sourceRoot":""}