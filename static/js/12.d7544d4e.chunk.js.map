{"version":3,"sources":["desktop/pages/Info/List.js","utils/DeriNumberFormat.js","desktop/pages/Info/Table.js","desktop/pages/Info/Chart.js"],"names":["HEADERS","COLUMNS","GET_POOL_URL","process","REACT_APP_INFO_HTTP_URL","columnFormat","catalog","data","className","toUpperCase","zone","indexOf","substring","length","address","formatAddress","liquidity","value","suffix","bToken","split","thousandSeparator","decimalScale","notional","inject","observer","loading","useState","allPoolData","setAllPoolData","history","useHistory","loadAllPoolData","a","axios","get","res","status","loaded","useEffect","title","url","seriesType","cycle","defaultCycle","Object","keys","map","chain","index","headers","columns","columnRenders","onRowClick","d","push","dataSet","DeriNumberFormat","props","renderablity","setRenderablity","allowZero","others","undefined","isNaN","Math","abs","displayType","pagination","setData","page","setPage","count","setCount","pageSize","loadData","restUrl","Array","isArray","floor","header","onClick","style","cursor","col","call","AreaSeries","chartRef","useRef","seriesChartRef","series","curValue","setCurValue","curDate","setCurDate","curCycle","setCurCycle","lastDataRef","crosshairMove","param","point","current","seriesPrices","forEach","item","time","year","month","day","addAreaSeries","chart","areaSeries","priceLineVisible","lastValueVisible","topColor","bottomColor","lineColor","priceFormat","precision","minMove","sort","item1","item2","timestamp","dateFormat","Date","last","timeScale","fitContent","loadHistogramData","histogramSeries","Number","last_24h","addHistogramSeries","color","type","priceFormatter","price","priceScale","applyOptions","scaleMargins","top","bottom","rect","document","querySelector","getBoundingClientRect","createChart","localization","convertToInternationalCurrencySystem","locale","rightOffset","leftOffset","timeVisible","borderColor","borderVisible","width","height","position","mode","handleScroll","handleScale","crosshair","CrosshairMode","Normal","vertLine","labelVisible","visible","horzLine","grid","vertLines","horzLines","layout","backgroundColor","textColor","fontSize","initChart","subscribeCrosshairMove","unsubscribeCrosshairMove","removeSeries","remove","test","cycleSelect","ref"],"mappings":"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","file":"static/js/12.d7544d4e.chunk.js","sourcesContent":["import React, { useState, useEffect } from 'react'\r\nimport './info.less'\r\nimport Table from './Table'\r\nimport axios from 'axios'\r\nimport { formatAddress } from '../../../utils/utils'\r\nimport DeriNumberFormat from '../../../utils/DeriNumberFormat'\r\nimport { useHistory } from 'react-router-dom'\r\nimport Chart from './Chart'\r\nimport { inject, observer } from 'mobx-react'\r\nconst HEADERS = ['ZONE','POOL','BASE TOKEN','POOL ADDRESS','LIQUIDITY','TRADE VOLUME']\r\nconst COLUMNS = ['zone','catalog','bToken','address','liquidity','notional']\r\n\r\nconst GET_POOL_URL=`${process.env.REACT_APP_INFO_HTTP_URL}/get_pools`\r\n\r\nconst columnFormat = {\r\n  catalog : data => <span className='catalog'>{data.catalog.toUpperCase()}</span>,\r\n  zone : data => data.catalog.indexOf('-') > 0 ? data.catalog.substring(data.catalog.indexOf('-') + 1,data.catalog.length).toUpperCase() : '',\r\n  address : data => formatAddress(data.address),\r\n  liquidity : data => <DeriNumberFormat value={data.liquidity}  suffix={` ${data.bToken.split('|')[0]}`}  thousandSeparator={true} decimalScale={2}/>,  \r\n  notional : data =>  <DeriNumberFormat value={data.notional} suffix={` ${data.bToken.split('|')[0]}`}  thousandSeparator={true} decimalScale={2}/> ,\r\n}\r\nfunction List({loading}){\r\n  const [allPoolData, setAllPoolData] = useState({})\r\n  const history = useHistory()\r\n  const loadAllPoolData = async () => {\r\n    loading.loading();\r\n    const res = await axios.get(GET_POOL_URL);\r\n    if(res.status === 200 && res.data.data){\r\n      setAllPoolData(res.data.data)\r\n    }\r\n    loading.loaded();\r\n  }\r\n\r\n  const onRowClick = d => {\r\n    history.push(`/info/${d.address}/${d.catalog}/${d.bToken}/${d.chain}`)\r\n  }\r\n\r\n  useEffect(() => {\r\n    loadAllPoolData();\r\n    \r\n  }, [])\r\n\r\n\r\n  return(\r\n    <div className='info'>\r\n      <div className='title'>Deri Overview</div>\r\n      <div className='chart-box'>\r\n        <div className='chart'><Chart title='TVL' url = {`${process.env.REACT_APP_INFO_HTTP_URL}/get_liquidity_history`} seriesType='area'/> </div>\r\n        <div className='chart'><Chart title='Volume 24H' url = {`${process.env.REACT_APP_INFO_HTTP_URL}/get_trade_history`} seriesType='histogram' cycle={['W','M']} defaultCycle='M'/> </div>\r\n      </div>\r\n      <div className='table-by-network'>\r\n        {Object.keys(allPoolData).map((chain,index) => <Table title={chain} key={index} headers={HEADERS} columns={COLUMNS} columnRenders={columnFormat} onRowClick={d => onRowClick(d)} dataSet={allPoolData[chain]}/>)}\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\nexport default inject('loading')(observer(List))","import React,{useState,useEffect} from 'react'\r\nimport NumberFormat from 'react-number-format'\r\n\r\nexport default function DeriNumberFormat(props){\r\n  const [renderablity, setRenderablity] = useState(<span className='loading-line'></span>);\r\n\r\n  useEffect(() => {\r\n    const {allowZero,...others} = props \r\n    if(((typeof props.value !== 'object' && props.value !== undefined && props.value !== '' && props.value !== 'NaN') || ((isNaN(props.value) && Math.abs(props.value)) === 0 && allowZero === true ))) {\r\n      setRenderablity(<NumberFormat {...others} displayType = 'text' />)\r\n    } \r\n    return () => {};\r\n  }, [props.value]);\r\n\r\n  return renderablity;\r\n}","import React, { useState, useEffect } from 'react'\r\nimport axios from 'axios'\r\nimport { inject, observer } from 'mobx-react'\r\n\r\nfunction Table({title,dataSet,url,headers,columns,columnRenders = {},pagination,loading,onRowClick}){\r\n  const [data, setData] = useState([])\r\n  const [page, setPage] = useState(1)\r\n  const [count, setCount] = useState()\r\n  const [pageSize, setPageSize] = useState(10)\r\n\r\n  const loadData = async (url,page) => {\r\n    let restUrl = url;\r\n    if(pagination){\r\n      restUrl = `${restUrl}&page=${page}&page_amount=${pageSize}`\r\n    }\r\n    loading.loading()\r\n    const res = await axios.get(restUrl);\r\n    if(res.status === 200 && Array.isArray(res.data.data)){\r\n      setCount(res.data.count / pageSize)\r\n      if(res.data.count % pageSize > 0 ){\r\n        setCount(Math.floor(res.data.count / pageSize) +1)\r\n      }\r\n      setData(res.data.data)\r\n      setPage(page)\r\n      loading.loaded()\r\n    }\r\n  }\r\n\r\n  const prePage = () => {\r\n    if(page === 1){\r\n      return;\r\n    }\r\n    loadData(url,page - 1)\r\n  }\r\n  const nextPage = () => {\r\n    if(page === count){\r\n      return;\r\n    }\r\n\r\n    loadData(url,page +1)\r\n  }\r\n\r\n  useEffect(() => {\r\n    if(dataSet){\r\n      setData(dataSet)\r\n    } else {\r\n      loadData(url,1);\r\n    }\r\n  }, [url])\r\n  return(\r\n    <div className='info-table'>\r\n      <div className='t-title'>{title}</div>\r\n      <div className='tbody'>\r\n        <div className='theader'>\r\n          {headers.map((header,index) => <div className='col' key={index}>{header}</div>)}\r\n        </div>\r\n        {data.length > 0 ? data.map((d,index) => (\r\n          <div className='row' key={index} onClick={() => onRowClick && onRowClick(d)} style={{cursor : onRowClick ? 'pointer' : 'normal'}}>\r\n            {columns.map((col,index) => <div className='col' key={index}>{columnRenders[col] ? columnRenders[col].call(null,d) :d[col]}</div>)}\r\n          </div>))\r\n          :\r\n          <div className='row'><div className='col no-data'>No Data</div></div>\r\n          }\r\n         \r\n\r\n        {pagination && data.length > 0 && <div className='pagination row'>\r\n          <span className='arrow' onClick={prePage}> &lt; </span><span>Page {page} of {count}</span><span className='arrow' onClick={nextPage}> &gt; </span>\r\n        </div>}\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\nexport default inject('loading')(observer(Table))","import { useRef,useEffect,useState } from \"react\"\r\nimport { createChart, CrosshairMode } from \"lightweight-charts\";\r\nimport axios from \"axios\";\r\nimport dateFormat from 'dateformat'\r\nimport { convertToInternationalCurrencySystem } from \"../../../utils/utils\";\r\n\r\nexport default function AreaSeries({title,url,seriesType,cycle,defaultCycle}){\r\n  const chartRef = useRef(null);\r\n  const seriesChartRef = useRef(null);\r\n  const series = useRef(null)\r\n  const [curValue, setCurValue] = useState('')\r\n  const [curDate, setCurDate] = useState('')\r\n  const [curCycle, setCurCycle] = useState(defaultCycle)\r\n  const lastDataRef = useRef()\r\n\r\n\r\n  const initChart = () => {\r\n    const rect = document.querySelector('.info-chart').getBoundingClientRect()\r\n    const chart = createChart(chartRef.current, { \r\n      localization : {\r\n        priceFormatter: price => '$ ' + convertToInternationalCurrencySystem(price),\r\n        locale: 'en-US'\r\n      },\r\n      timeScale: {\r\n        rightOffset : 0,\r\n        leftOffset : 5,\r\n        timeVisible : true,\r\n        borderColor : '#fff',\r\n        borderVisible :  false\r\n      },\r\n      width: rect.width,\r\n      height: 200,\r\n      priceScale: {\r\n        position: 'none',\r\n        borderColor: '#fff',\r\n        borderVisible : false,\r\n        mode: 0,\r\n        scaleMargins: {\r\n          top: 0.35,\r\n          // bottom : 0\r\n        },\r\n      },\r\n\r\n      handleScroll: false,\r\n      handleScale: false,\r\n      crosshair: {\r\n        mode: CrosshairMode.Normal,  \r\n        vertLine: {\r\n          labelVisible : false,  \r\n          visible : false\r\n        },\r\n        horzLine: {\r\n          labelVisible : false,  \r\n          visible : false\r\n        },\r\n      },\r\n      grid: {\r\n        vertLines: {\r\n          visible: false,\r\n        },\r\n        horzLines: {\r\n          visible: false,\r\n        },\r\n      },\r\n      layout: {\r\n        backgroundColor: '#212327',\r\n        textColor: '#fff',\r\n        fontSize: 12\r\n      },\r\n    });\r\n    seriesChartRef.current = chart\r\n    return chart;\r\n  }\r\n\r\n  const crosshairMove = param => {\r\n      if (!param.point) {\r\n        setCurDate('')\r\n        if(lastDataRef.current){\r\n          setCurValue(lastDataRef.current)\r\n        }\r\n        return;\r\n      }\r\n      param.seriesPrices.forEach(item => {\r\n        if(item){\r\n          setCurValue(item)\r\n        }\r\n      })\r\n      param.time && setCurDate(`${param.time.year}-${param.time.month}-${param.time.day} (UTC)`)\r\n  }\r\n\r\n  const addAreaSeries = async(chart) => {\r\n    const areaSeries = chart.addAreaSeries({\r\n      priceLineVisible : false,\r\n      lastValueVisible: false,\r\n      topColor: 'RGBA(0,101,159,.5)',\r\n      bottomColor: 'RGBA(0,101,159,0)',\r\n      lineColor: 'RGB(0,101,159)',\r\n      priceFormat: {        \r\n        precision: 1,\r\n        minMove : '1000',\r\n      }\r\n    })\r\n  \r\n    \r\n    const res = await axios.get(url)\r\n    if(res.status === 200 && Array.isArray(res.data.data)){\r\n      let data = res.data.data.sort((item1,item2) => {\r\n        if(item1.timestamp > item2.timestamp) {\r\n          return 1\r\n        } else if(item1.timestamp < item2.timestamp){\r\n          return -1\r\n        } else {\r\n          return 0\r\n        }\r\n      })\r\n      data = data.map(d => ({time : dateFormat(new Date(d.timestamp * 1000),'yyyy-mm-dd'),value : d.value}))\r\n      areaSeries.setData(data)\r\n      const last = data[data.length -1].value\r\n      setCurValue(last)\r\n      lastDataRef.current = last\r\n    }\r\n    series.current = areaSeries\r\n    chart.timeScale().fitContent();\r\n    return areaSeries;\r\n  }\r\n\r\n  const loadHistogramData = async (url,histogramSeries) => {\r\n    const res = await axios.get(url)\r\n    if(res.status === 200 && Array.isArray(res.data.data)){\r\n      const data = res.data.data.sort((item1,item2) => {\r\n        if(item1.timestamp > item2.timestamp) {\r\n          return 1\r\n        } else if(item1.timestamp < item2.timestamp){\r\n          return -1\r\n        } else {\r\n          return 0\r\n        }\r\n      }).map(d => ({time : dateFormat(new Date(d.timestamp * 1000),'yyyy-mm-dd'),value : Number(d.value)}))\r\n      const last = res.data.last_24h ? res.data.last_24h : res.data[data.length -1].value\r\n      histogramSeries.setData(data)\r\n      setCurValue(last)\r\n      lastDataRef.current = last\r\n      seriesChartRef.current && seriesChartRef.current.timeScale().fitContent();\r\n    }\r\n  }\r\n\r\n  const addHistogramSeries = async (chart) => {\r\n    const histogramSeries = chart.addHistogramSeries({\r\n      color: '#00659F',\r\n      priceLineVisible : false,\r\n      lastValueVisible: false,\r\n      priceFormat: {\r\n        type: \"volume\",\r\n        priceFormatter: price => '$ ' + price\r\n      }\r\n    })\r\n    histogramSeries.priceScale().applyOptions({\r\n      scaleMargins: {\r\n        top: 0.25,\r\n        bottom: 0,\r\n      },\r\n    });    \r\n    loadHistogramData(url,histogramSeries)\r\n    series.current = histogramSeries\r\n    return histogramSeries;\r\n  }\r\n\r\n  const cycleSelect = cycle => {\r\n    setCurCycle(cycle)\r\n    url = /\\?/.test(url) ? `${url}&cycle=${cycle}` : `${url}?cycle=${cycle}`\r\n    loadHistogramData(url,series.current)\r\n  }\r\n\r\n  useEffect(() => {\r\n    const chart = initChart();\r\n    if(seriesType === 'area'){\r\n      addAreaSeries(chart)\r\n    }\r\n    if(seriesType === 'histogram'){\r\n      addHistogramSeries(chart)\r\n    }\r\n    chart.subscribeCrosshairMove(crosshairMove);\r\n    return () => {\r\n      if(chart){\r\n        chart.unsubscribeCrosshairMove(crosshairMove)\r\n        if(series.current){\r\n          chart.removeSeries(series.current);\r\n        }\r\n        chart.remove();\r\n      }\r\n    }\r\n  }, [url,seriesType])\r\n\r\n  return(\r\n    <div className='info-chart'>\r\n      <div className='chart-title'>\r\n        <div className='title-label'>{title}</div>\r\n        <div className='title-value'>{curValue ? `$${convertToInternationalCurrencySystem(curValue)}` : ''} </div>\r\n        <div className='title-date'>{curDate} </div>\r\n      </div>\r\n      {cycle && <div className='cycle-c'>\r\n        {cycle.map((item,index) => <div className={`cycle-item ${item === curCycle && 'selected'}`} key={index} onClick={() => cycleSelect(item)}>{item}</div>)}\r\n      </div>}\r\n      <div className='series' ref={chartRef}></div>\r\n    </div>\r\n  )\r\n}\r\n"],"sourceRoot":""}